#include <iostream>
#include <deque>
#include <vector>
#include <gtest/gtest.h>

std::vector<int> maxSlidingWindow(const std::vector<int>& nums, int k)
{
    std::deque<int> dq;       // åŒç«¯é˜Ÿåˆ—ï¼Œå­˜å‚¨ä¸‹æ ‡
    std::vector<int> result;  // å­˜å‚¨ç»“æœ

    for (int i = 0; i < nums.size(); i++) {
        // ç§»å‡ºé˜Ÿåˆ—ä¸­ä¸åœ¨çª—å£èŒƒå›´å†…çš„å…ƒç´ 
        if (!dq.empty() && dq.front() <= i - k) {
            dq.pop_front();
        }

        // ä»é˜Ÿå°¾ç§»é™¤æ‰€æœ‰æ¯”å½“å‰å…ƒç´ å°çš„å…ƒç´ 
        while (!dq.empty() && nums[dq.back()] < nums[i]) {
            dq.pop_back();
        }

        // å°†å½“å‰å…ƒç´ çš„ä¸‹æ ‡åŠ å…¥é˜Ÿåˆ—
        dq.push_back(i);

        // å½“çª—å£è¾¾åˆ°å¤§å° k æ—¶ï¼Œè®°å½•å½“å‰çª—å£çš„æœ€å¤§å€¼
        if (i >= k - 1) {
            result.push_back(nums[dq.front()]);
        }
    }
    return result;
}

TEST(Algorithms, MonotonicQueue)
{
    std::vector<int> nums = {1, 3, -1, -3, 5, 3, 6, 7};
    int k = 3;
    std::vector<int> result = maxSlidingWindow(nums, k);

    for (int max_val : result) {
        std::cout << max_val << " ";
    }
    std::cout  << std::endl;
}

/*
å•è°ƒé˜Ÿåˆ—çš„å®šä¹‰
å•è°ƒé˜Ÿåˆ—æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç¡®ä¿é˜Ÿåˆ—ä¸­çš„å…ƒç´ å€¼æŒ‰æŸç§å•è°ƒå…³ç³»æ’åˆ—ï¼ˆä¾‹å¦‚é€’å¢æˆ–é€’å‡ï¼‰ã€‚åœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œé€‰æ‹©é€‚å½“çš„å•è°ƒå…³ç³»å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ 
O(1) æ—¶é—´å†…è·å–é˜Ÿåˆ—ä¸­æœ€å€¼ã€‚

å¸¸ç”¨çš„ä¸¤ç§å•è°ƒé˜Ÿåˆ—ï¼š

å•è°ƒé€’å¢é˜Ÿåˆ—ï¼šä»é˜Ÿå¤´åˆ°é˜Ÿå°¾å…ƒç´ é€’å¢ï¼Œé€‚ç”¨äºæ±‚è§£æœ€å°å€¼ã€‚
å•è°ƒé€’å‡é˜Ÿåˆ—ï¼šä»é˜Ÿå¤´åˆ°é˜Ÿå°¾å…ƒç´ é€’å‡ï¼Œé€‚ç”¨äºæ±‚è§£æœ€å¤§å€¼ã€‚
å•è°ƒé˜Ÿåˆ—çš„å®ç°æ€è·¯
å‡è®¾æˆ‘ä»¬è¦æ±‚ä¸€ä¸ªé•¿åº¦ä¸º ğ‘˜
k çš„æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼š

ç»´æŠ¤ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼šé˜Ÿåˆ—ä¸­å­˜å‚¨çš„æ˜¯ä¸‹æ ‡ï¼Œä¸æ˜¯å€¼ã€‚è¿™æ ·å¯ä»¥é€šè¿‡ä¸‹æ ‡åˆ¤æ–­é˜Ÿå¤´å…ƒç´ æ˜¯å¦å·²ç»æ»‘å‡ºçª—å£ã€‚
ä¿æŒé˜Ÿåˆ—å•è°ƒé€’å‡ï¼š
å½“æ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ æ—¶ï¼Œå°†åŒç«¯é˜Ÿåˆ—ä¸­å°äºè¯¥å…ƒç´ çš„å…ƒç´ å…¨éƒ¨å¼¹å‡ºï¼Œå› ä¸ºå®ƒä»¬ä¸å¯èƒ½å†æˆä¸ºæœ€å¤§å€¼ã€‚
æ’å…¥åï¼Œå¦‚æœé˜Ÿå¤´å…ƒç´ å¯¹åº”çš„å€¼è¶…å‡ºäº†çª—å£èŒƒå›´ï¼Œåˆ™å°†å…¶ä»é˜Ÿå¤´å¼¹å‡ºã€‚
å–æœ€å¤§å€¼ï¼šæ¯æ¬¡çª—å£æ»‘åŠ¨æ—¶ï¼Œé˜Ÿå¤´å…ƒç´ å°±æ˜¯å½“å‰çª—å£çš„æœ€å¤§å€¼ã€‚
*/